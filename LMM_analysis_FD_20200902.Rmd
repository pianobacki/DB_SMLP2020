---
title: "LMM Analysis Fixation Duration 0-2sec"
author: "Daniel Backhaus"
date: "september 2020"
output:
  slidy_presentation:
    css: font.css
  beamer_presentation: default
  ioslides_presentation: default
header-includes: \usepackage{amsmath}
editor_options:
  chunk_output_type: console
---


```{r setup, include=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)

rm(list=ls())
setwd("/Users/Daniel/CloudStation/Arbeit/03_Allgemeine Psychologie/2020/Git_SMLP2020/")

set.seed(123)

library(MASS)
library(lmerTest)
library(lme4)
library(lattice) 
library(MASS)
library(sjmisc)
library(sjPlot)

library(tidyverse)
library(grid)
library(gridExtra)
library(GGally)
library(tidyverse)
source("/Users/Daniel/CloudStation/Arbeit/03_Allgemeine Psychologie/2019/LMM_Seminar/functions/mixedDesign.v0.6.3.R")
source("/Users/Daniel/CloudStation/Arbeit/03_Allgemeine Psychologie/2019/LMM_Seminar/functions/GenDatLMM.R")  # simulation functions
# devtools::install_github("hohenstein/remef")
library(remef)      
source("/Users/Daniel/CloudStation/Arbeit/03_Allgemeine Psychologie/2019/LMM_Seminar/functions/dotplot.RK.R") 


ginv2 <- function(x) # define a function to make the output nicer
  MASS::fractions(provideDimnames(MASS::ginv(x),base=dimnames(x)[2:1]))

theme_set(theme_bw(base_size=18))
```

# Load data

Define DV

```{r, echo=FALSE, message=FALSE, warning=FALSE}

Filename<-"/Users/Daniel/CloudStation/Arbeit/03_Allgemeine Psychologie/2020/Git_SMLP2020/DataImageFix.rda"
load(Filename)#Data.Image.Fix

#Data.Image.Fix<-Data.Image %>% 
#  filter(MBody==2, Fix==1, eventchange==1)

#Data.Image.Sac<-Data.Image %>% 
#  filter(MBody==2, Sac==1, eventchange==1)

#Outfile<-sprintf('/Users/Daniel/CloudStation/Arbeit/03_Allgemeine #Psychologie/Experimente/MBody2/Analyse/Data/Converted/DataImageFix.rda')
#save(Data.Image.Fix,file=Outfile)
#Outfile<-sprintf('/Users/Daniel/CloudStation/Arbeit/03_Allgemeine #Psychologie/Experimente/MBody2/Analyse/Data/Converted/DataImageSac.rda')
#save(Data.Image.Sac,file=Outfile)

d<-Data.Image.Fix %>% 
  filter(MBody==2, Fix==1, eventchange==1, sample>=1, sample<=240, nthfix!=1,revnthfix!=1, is.na(filterout)) %>% 
  #filter(nthfix>1 & nthfix < 6) %>% 
  select(VP,trial,Img,cond,fd, nthpres) %>% 
  mutate(DV=fd, DV_org=DV) %>% 
  mutate(cond=as.factor(cond), nthpres=as.factor(nthpres))


#add noise

noise<-rnorm(length(d$DV), mean = 0, sd = 1/120*1000)
d <- d %>%
  mutate(noise=noise) %>%
  mutate(DV=abs(DV+noise))



d<-d %>% 
  mutate(FT= case_when(
    cond==1 | cond ==2 ~ "FreeViewing",
    cond==3 | cond ==4 ~ "GuessTime"
      )) %>% 
  mutate(FB= case_when(
    cond==1 | cond ==3 ~ "SittingChinrest",
    cond==2 | cond ==4 ~ "Standing"
  )) %>% 
  mutate(Factor= case_when(
    cond==1  ~ "FreeViewing_SittingChinrest",
    cond==2  ~ "FreeViewing_Standing",
    cond==3  ~ "GuessTime_SittingChinrest",
    cond==4  ~ "GuessTime_Standing"
  )) %>% 
  mutate(FT=as.factor(FT), FB=as.factor(FB), Factor=as.factor(Factor),VP=as.factor(VP),Img=as.factor(Img),DV_log=log(DV), DV_reci= 1/DV)


# Create effect coding for Factor Task (FT) and Factor Body (FB)

d <- d %>% 
             mutate(FT.e = if_else(FT == "FreeViewing", -.5, +.5),  # effect code
                    FT.t = FT.e + .5) %>%                 # treatment contrast
             mutate(FB.e = if_else(FB == "SittingChinrest", -.5, +.5),  # effect code
                    FB.t = FB.e + .5)                # treatment contrast
 
contrasts(d$FT) <- contr.sdif(2) 
contrasts(d$FB) <- contr.sdif(2)


mat_myC <- model.matrix(~ FT*FB, d)
d[, 19:22] <- mat_myC
names(d)[19:22] <- c("GM", "n.FT", "n.FB", "n.FAB") 


# Have a look
head(d)
summary(d)
glimpse(d)


```


# Check DV Distribution

```{r}
plot(density(d$DV))
plot(density(d$DV_log))
plot(density(d$DV_reci))

boxcox(DV~ Img, data=d)
```

Transformation required?

0 = log

-1 = reciproc

1 = none

```{r}
d <- d %>% 
  mutate(DV=DV_log)
labelDV<-sprintf("Log Fixation Duration 0-2sec")
```


plot Outlier

```{r}
plot(DV~FT, data=d)
plot(DV~FB, data=d)

```


# Descriptive statistics

Means
```{r}
FB_M_SD <- d %>% 
              group_by(FB, FB.e, FB.t) %>% 
              summarise(N = n(), 
                        M_DV = mean(DV),  
                        SD_DV = sd(DV))
                        
FB_M_SD

FT_M_SD <- d %>% 
              group_by(FT, FT.e, FT.t) %>% 
              summarise(N = n(), 
                        M_DV = mean(DV),  
                        SD_DV = sd(DV))
                        
FT_M_SD
```
                
# Fit maximal LMM

## Modelselection

```{r cache=TRUE}

#lmm.max.fac <- lmer(DV ~ 1+FT+FB+FT:FB + (1+FT+FB+FT:FB | VP) + (1+FT+FB+FT:FB | Img), data=d, REML=FALSE)#sf
#lmm.max.num <- lmer(DV ~ 1+n.FT+n.FB+n.FAB + (1+n.FT+n.FB+n.FAB | VP) + (1+n.FT+n.FB+n.FAB | Img), data=d, #REML=FALSE)#sf
#
#anova(lmm.max.fac, lmm.max.num) #same
##remove correlations
#lmm1<-lmer(DV ~ 1+n.FT+n.FB+n.FAB + (1+n.FT+n.FB+n.FAB || VP) + (1+n.FT+n.FB+n.FAB || Img), data=d, #REML=FALSE) #sf
#summary(lmm1)
#
## remove least varying parameter 
##(FB|Img)
#lmm2<-lmer(DV ~ 1+n.FT+n.FB+n.FAB + (1+n.FT+n.FB+n.FAB || VP) + (1+n.FT+n.FAB || Img), data=d, REML=FALSE)#nc
#summary(lmm2)
#
## (FB|VP)
#lmm3<-lmer(DV ~ 1+n.FT+n.FB+n.FAB + (1+n.FT+n.FAB || VP) + (1+n.FT+n.FAB || Img), data=d, REML=FALSE)#nc
#summary(lmm3)
#
## (FAB|Img)
#lmm4<-lmer(DV ~ 1+n.FT+n.FB+n.FAB + (1+n.FT+n.FAB || VP) + (1+n.FT|| Img), data=d, REML=FALSE)#nc
#summary(lmm4)
#
## (FAB|VP)
#lmm5<-lmer(DV ~ 1+n.FT+n.FB+n.FAB + (1+n.FT || VP) + (1+n.FT|| Img), data=d, REML=FALSE)#converge
#summary(lmm5) 
#
##try smaler model 
#lmm6a<-lmer(DV ~ 1+n.FT+n.FB+n.FAB + (1 +n.FT || VP) + (1 | Img), data=d, REML=FALSE)#converge
#lmm6b<-lmer(DV ~ 1+n.FT+n.FB+n.FAB + (1 | VP) + (1 +n.FT|| Img), data=d, REML=FALSE)#converge
lmm6c<-lmer(DV ~ 1+n.FT+n.FB+n.FAB + (1 | VP) + (1 | Img), data=d, REML=FALSE)#converge
#
#anova(lmm5,lmm6a)
#anova(lmm5,lmm6b)
#anova(lmm5,lmm6c)
#
#summary(lmm6c) 
#
##choose smallest to held comparability for other time selections (other than 0 - 200ms)

lmm<-lmm6c

summary(lmm)
summary(rePCA(lmm))

print(summary(lmm), corr=FALSE)

```

## Check random effects structure

```{r}
summary(rePCA(lmm))
```


## Check residuals -  Base R

```{r fig.width=12, fig.height=4 }
par(mfcol=c(1,3))

qqnorm(resid(lmm))

plot(fitted(lmm), resid(lmm))

simdat_subset <- subset(d, DV > 0)
try(boxcox(DV ~ 1+n.FT+n.FB+n.FAB, data=simdat_subset))
par(mfcol=c(1,1))
```


```{r fig.width=12, fig.height=8 }

simdat <- fortify.merMod(model=lmm, data = d)

p_lmm_res1 <- ggplot(simdat, aes(.fitted,.resid)) + geom_point(colour="blue", size=.3) +
                 facet_grid( ~ FT*FB) + geom_hline(yintercept=0) + theme_bw()

p_lmm_res2 <- ggplot(simdat, aes(.fitted, .resid)) +
                 geom_point(shape=I(".")) +  
                 xlab("Fitted values") + ylab("Standardized residuals") + theme_bw() +
                 geom_hline(yintercept=0) + geom_density2d(size=1)  #+ geom_hex()

# Plot
grid.arrange(p_lmm_res1, p_lmm_res2, nrow=2)
```


# rmMRA, effect correlations, factor correlations, rmAOV  

## Subjects rmMRA, effect correlations, factor correlations, rmAOV  

## Repeated-measures multiple regression (rmMRA) - subjects

These tests represent _a priori_ contrasts.

```{r}
# Fit rmMRA 
rmMRA_coef_subj <- d %>% 
                   split(.$VP) %>% 
                   map(~ lm(DV ~ 1+FT+FB+FT:FB, .)) %>% 
                   map_dfr( ~ as.data.frame(t(as.matrix(coef(.)))))
names(rmMRA_coef_subj) <- c("Intercept", "GuessTime-FreeViewing", "Standing-SittingChinrest", "InteractionFT:FB")


# Fixed effects (w/ tidyverse)
tab_Est_SE_subj <- rmMRA_coef_subj %>% 
                   rownames_to_column("VP") %>% 
                   gather(key = "Coeff", value = "value", -VP, factor_key = TRUE) %>% 
                   group_by(Coeff) %>% 
                   summarise(Est = mean(value), SE = sd(value), t = Est/SE)
tab_Est_SE_subj
```


## Within-subject effect correlations 

```{r}
# Correlations between GM and effects (CPs)
ggscatmat(rmMRA_coef_subj, columns = 1:4, alpha = 1/3) + 
  theme_bw(base_size=18) 
```
 
## Within-subject correlations of factor levels 
 
```{r}
# Correlations between measures (r's) -- don't confuse with CPs

simdat_subj <- d %>% 
               group_by(VP, FT, FB) %>% 
               summarise(N = n(), DV_subj = mean(DV), SD_subj=sd(DV)) %>% 
               ungroup()


simdat_subj %>% 
            dplyr::select(VP, FT,FB, DV_subj) %>% 
            mutate(Factor=paste(FT, FB, sep = "_")) %>% 
            dplyr::select(VP, Factor, DV_subj) %>% 
            spread(Factor,DV_subj) %>% 
            ggscatmat(columns = 2:5, alpha = 1/3) + 
            #coord_cartesian(xlim=c(250, 550), ylim=c(250, 550)) +
            theme_bw(base_size=18) 
```


## Repeated-measures Anova  (rmAOV) - subjects

```{r}
simdat_subj <-simdat_subj %>% 
              mutate(Factor=paste(FT, FB, sep = "_"))

subj_aov <- aov(DV_subj ~  Factor + Error(VP/Factor), data=simdat_subj)
coefficients(subj_aov, contrasts=list(MASS::contr.sdif))
```


## Images rmMRA, effect correlations, factor correlations, rmAOV  

## Repeated-measures multiple regression (rmMRA) - Images

These tests represent _a priori_ contrasts.

```{r}
# Fit rmMRA 
rmMRA_coef_Img <- d %>% 
                   split(.$Img) %>% 
                   map(~ lm(DV ~ 1+FT+FB+FT:FB, .)) %>% 
                   map_dfr( ~ as.data.frame(t(as.matrix(coef(.)))))
names(rmMRA_coef_Img) <- c("Intercept", "GuessTime-FreeViewing", "Standing-SittingChinrest", "InteractionFT:FB")


# Fixed effects (w/ tidyverse)
tab_Est_SE_Img <- rmMRA_coef_Img %>% 
                   rownames_to_column("Img") %>% 
                   gather(key = "Coeff", value = "value", -Img, factor_key = TRUE) %>% 
                   group_by(Coeff) %>% 
                   summarise(Est = mean(value), SE = sd(value), t = Est/SE)
tab_Est_SE_Img
```


## Within-Img effect correlations  
 
```{r}
# Correlations between GM and contrasts (CPs)

# Fit rmMRA 
rmMRA_coef_Img <- d %>% 
                   split(.$Img) %>% 
                   map(~ lm(DV ~ 1+ FT+FB+FT:FB, .)) %>% 
                   map_dfr( ~ as.data.frame(t(as.matrix(coef(.)))))
names(rmMRA_coef_Img) <- c("Intercept", "GuessTime-FreeViewing", "Standing-SittingChinrest", "InteractionFT:FB")

ggscatmat(rmMRA_coef_Img, columns = 1:4, alpha = 1/3) + theme_bw(base_size=18) 
```


## Within-Img correlations of factor levels 
 
```{r}
# Correlations between measures (r's) 
simdat_Img <- d %>% 
               group_by(Img, FT, FB) %>% 
               summarise(N = n(), DV_Img = mean(DV), SD_Img=sd(DV)) %>% 
               ungroup()


simdat_Img %>% 
            dplyr::select(Img, FT, FB, DV_Img) %>% 
            mutate(Factor=paste(FT, FB, sep = "_")) %>% 
            dplyr::select(Img, Factor, DV_Img) %>% 
            spread(Factor, DV_Img) %>% 
            ggscatmat(columns = 2:5, alpha = 1/3) + 
            #coord_cartesian(xlim=c(250, 550), ylim=c(250, 550)) +
            theme_bw(base_size=18) 
```

## Repeated-measures Anova  (rmAOV) - Image

```{r}
simdat_Img <-simdat_Img %>% 
              mutate(Factor=paste(FT, FB, sep = "_"))

Img_aov <- aov(DV_Img ~  Factor + Error(Img/Factor), data=simdat_Img)
coefficients(Img_aov, contrasts=list(MASS::contr.sdif))
```



# Significance of fixed-effects (contrasts)



```{r eval=TRUE, cache=TRUE}
# fixed effects
fixef(lmm)

# profiling
#p_lmm <- profile(lmm, which="beta_")
#confint(p_lmm)

# bootstrap
#confint(lmm, parm=c("(Intercept)", "n.FT", "n.FB", "n.FAB"),
#        method="boot")

# Wald
#confint(lmm,parm=c("(Intercept)","n.FT","n.FB","n.FAB"),
#        method="Wald")
```

## Table of LMM partial effects

This table copy/pastes nicely into a Word.docx table...

```{r fig.width=5, fig.height=5}
labels <- c("GuessTime-FreeViewing", "Standing-SittingChinrest", "InteractionFT:FB") 

keep.terms <- names(fixef(lmm)[-1])

## Computing p-values via Wald-statistics approximation (treating t as Wald z).   
tab_model(lmm, terms=keep.terms, pred.labels=labels,
          show.se=TRUE, show.stat=TRUE, show.ci = FALSE, string.se = "SE", 
          show.re.var=FALSE, show.obs=TRUE,
          emph.p = FALSE, dv.labels=labelDV , show.icc = FALSE)
summary(lmm)

```

## Visualize LMM partial effects (1)

We visualize the effects. There are two formats. First, we plot the coefficients as a forest plot. This is the most direct way of converting the effects into graph, because the estimates represent the effect tested. (We leave out the GM.)
 
```{r fig.width=5, fig.height=5}
plot_model(lmm, title = "Contrasts",
           terms=keep.terms,           
           axis.labels = labels,
           colors = "bw", show.values = TRUE, show.p = TRUE, value.offset = .1, value.size = 5,
           dot.size = 3, line.size = 1, vline.color = "grey", width = 0) + theme_bw()
```

```{r fig.height=12, fig.width=15}

# fixed effects
lmm.fix<-fixef(lmm)[-1]

# profiling
#p_lmm <- profile(lmm, which="beta_")
#confint(p_lmm)

# Wald
lmm.fixconf<-data.frame(M=fixef(lmm)[-1],
                        as.data.frame(confint(lmm,parm=c("(Intercept)","n.FT","n.FB","n.FAB"),method="Wald")[-1,]),
                        Contrast=c("GuessTime-FreeViewing", "Standing-SittingChinrest", "InteractionFT:FB"))

names(lmm.fixconf)<-c("M","min","max","Contrast")


p0<-ggplot(data=lmm.fixconf, aes(x=Contrast, y=M, ymin=min, ymax=max)) +
  geom_point()+geom_errorbar(width=.1)+geom_hline(yintercept=0, color='red', size=1)+ 
  scale_x_discrete(limits=lmm.fixconf$Contrast)+
  xlab("Contrasts")+
  ylab(labelDV)+
  theme_bw(base_size=18) +
  theme(legend.justification=c(1,0), legend.position=c(1,0),
        legend.background=element_rect(fill="white", color="black")) +
  ggtitle("Fixed Effects 95%-Confidence Intervals")
p0
```

## Visualize LMM partial effects (2)


```{r, message=FALSE}
d <- fortify.merMod(lmm)

d$pe_DV <- remef(lmm, ran="all") # remove all random effects

tab_lmmse <- d %>% 
             group_by(Factor) %>% # Compute M + SE
             summarize(N = n(), M = mean(pe_DV), 
                       SD = sd(pe_DV), SE = SD/sqrt(N), CI=1.96*SE,
                       SD_res = sd(.resid), SE_res =SD_res/sqrt(N), CI_res=1.96*SE_res )

tab_lmmse

tab_real <- d %>% 
             group_by(Factor) %>% # Compute M + SE
             summarize(N = n(), M = mean(DV), 
                       SD = sd(DV), SE = SD/sqrt(N), CI=1.96*SE)

tab_real

d$DVfit<-fitted.values(lmm)

tab_model <- d %>% 
             group_by(Factor) %>% # Compute M + SE
             summarize(N = n(), M = mean(DVfit), 
                       SD = sd(DV), SE = SD/sqrt(N), CI=1.96*SE)

tab_model

```



## Standard errors - between-subjects (1)

How does partial-effect CI compare with traditional SEs?  We start with a computation of **invalid** standard errors (SEs). Note that they are **invalid** because the computation assumes that all observations are independent. We know they are not because Factor is a within-subject and a within-item factor.  (Of course, between-item standard errors computed this way would also be invalid.)

```{r}
tab_bsse <- d %>% 
            group_by(VP, Factor) %>% 
            summarise(DV = mean(DV)) %>% 
            group_by(Factor) %>% 
            summarise(N = n(), M = mean(DV), SD = sd(DV), SE = SD/sqrt(N), CI=1.96*SE)
tab_bsse
```


## Standard errors - between-image (1)

We compute **invalid** standard errors (SEs). Note that they are **invalid** because the computation assumes that all observations are independent. We know they are not because Factor is a within-subject and a within-item factor.  (Of course, between-item standard errors computed this way would also be invalid.)

```{r}
tab_bise <- d %>% 
            group_by(Img, Factor) %>% 
            summarise(DV = mean(DV)) %>% 
            group_by(Factor) %>% 
            summarise(N = n(), M = mean(DV), SD = sd(DV), SE = SD/sqrt(N), CI=1.96*SE)
tab_bise
```

## Standard errors - within-subjects (2)

A more appropriate method for within-subject effects is to remove between-subject differences and compute the standard errors relative to each subject's mean. These are so-called _within-subject_ standard errors. We also apply a correction according to Morey (2008).

```{r}
d <- d %>% 
               group_by(VP) %>% 
               mutate(M_VP = mean(DV)) # compute subject means

d$DV_VP <- d$DV - d$M_VP + mean(d$M_VP)
# subtract subject means from their measures and ...
# ... add grand mean (i.e., mean of subjects' means)

k <- length(unique(d$Factor)) # n cells of design
mf <- sqrt(k/(k-1))                # Morey factor

tab_wsse <- d %>% 
            group_by(VP, Factor) %>% 
            summarise(DV = mean(DV_VP)) %>% 
            group_by(Factor) %>% 
            summarize(N = n(), M = mean(DV), SD = sd(DV), 
                      SE = mf*sd(DV)/sqrt(N), CI=1.96*SE)
tab_wsse
```


## Standard errors - within-images (3)

We can also compute standard errors relative to each item's mean, that is a within-item standard error. Again, also with application of the correction factor (Morey, 2008).

```{r}
d <- d %>% 
          group_by(Img) %>% 
          mutate(M_Img = mean(DV)) # compute item means

d$DV_Img <- d$DV - d$M_Img + mean(d$M_Img)
# subtract item means from their measures and ...
# ... add grand mean (i.e., mean of items' means) 

tab_wise <- d %>% 
            group_by(Img, Factor) %>% 
            summarise(DV = mean(DV_Img)) %>% 
            group_by(Factor) %>% 
            summarize(N = n(), M = mean(DV), SD = sd(DV),
                      SE = mf*sd(DV)/sqrt(N), CI=1.96*SE)
tab_wise
```

Given the lack of independence of observations on the same item (clustering), within-item SEs are smaller than between-item SEs. 

## Standard errors - within subjects and within images (4)

```{r}
d$DV_VP_Img <- d$DV - d$M_Img - d$M_VP + mean(d$M_Img) + mean(d$M_VP)
# subtract item means and subject means from their measures and ...
# ... add grand mean 

tab_wsiseMF <- d %>% 
            group_by(VP, Img, Factor) %>% 
            summarise(DV = mean(DV_VP_Img)) %>% 
            group_by(Factor) %>% 
            summarize(N = n(), M = mean(DV), SD = sd(DV),
                      SE = mf*sd(DV)/sqrt(N), CI=1.96*SE)
tab_wsiseMF
tab_wsise <- d %>% 
            group_by(VP, Img, Factor) %>% 
            summarise(DV = mean(DV_VP_Img)) %>% 
            group_by(Factor) %>% 
            summarize(N = n(), M = mean(DV), SD = sd(DV),
                      SE = sd(DV)/sqrt(N), CI=1.96*SE)
tab_wsise
```


## Combine results


```{r fig.width=8, fig.height=8}
# combine results into one data frame
tab <- rbind( #cbind(tab_bsse[ , c(1,3,6)], Effects = "Between-subject"),
              #cbind(tab_bise[ , c(1,3,6)], Effects = "Between-image"),
              #cbind(tab_wsse[ , c(1,3,6)], Effects = "Within-subject"),
              #cbind(tab_wise[ , c(1,3,6)], Effects = "Within-item"),
              #cbind(tab_wsiseMF[,c(1,3,6)],Effects = "Within-subject & -item: Morey factor"),
              #cbind(tab_wsise[, c(1,3,6)], Effects = "Within-subject & -item"),
              cbind(tab_lmmse[, c(1,3,6)], Effects = "LMM partial effect"),
              cbind(tab_real[, c(1,3,6)], Effects =  "real means"),
              cbind(tab_model[, c(1,3,6)], Effects =  "Model fit"))
tab
```

## Graph

```{r fig.height=12, fig.width=15}
# create figure
tab$FactorL <- as.numeric(tab$Factor) + as.numeric(tab$Effects)/20 - 0.01
p1 <- ggplot(data=tab, aes(x=Factor, y=M, ymin=M-CI, ymax=M+CI, 
                            group=Effects, colour=Effects)) +
  #scale_color_manual(name="Conf intervals", values=c("darkblue","violet", "blue", "green", "black", "orange", "red","grey","darkgreen")) +  
  scale_color_manual(name="Conf intervals", values=c( "red","black","green")) +  
  geom_point() + geom_line() + 
  geom_errorbar(width=.1, aes(x=FactorL)) + 
  labs(x="Factor", y=labelDV) + 
  #coord_cartesian(ylim=c(300, 500)) +
  theme_bw(base_size=18) +
  theme(legend.justification=c(1,0), legend.position=c(1,0),
        legend.background=element_rect(fill="white", color="black")) +
  ggtitle("Comparison of Factor 95%-Confidence Intervals")
p1
```

# Appendix

```{r results='markup'}
devtools::session_info()
```
